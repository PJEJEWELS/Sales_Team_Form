<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sales Master Form</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-image: url('ornaments.jpg');
      background-size: cover;
      background-repeat: no-repeat;
      background-attachment: fixed;
    }
    .logo {
      position: fixed;
      top: 10px;
      left: 10px;
      width: 100px;
    }
    .form-container {
      max-width: 600px;
      margin: 0 auto;
      padding: 10px;
      border: 1px solid #ddd;
      background-color: rgba(249, 249, 249, 0.9);
    }
    .form-container label {
      font-weight: bold;
      margin-top: 5px;
      display: block;
    }
    .form-container input,
    .form-container select {
      width: 100%;
      padding: 8px;
      margin: 5px 0;
      box-sizing: border-box;
      border: 1px solid #ccc;
    }
    .form-container button {
      background-color: #4CAF50;
      color: white;
      padding: 10px 20px;
      border: none;
      cursor: pointer;
      width: 100%;
    }
    .form-container button:hover {
      background-color: #45a049;
    }
    #successMessage, #errorMessage {
      display: none;
      padding: 10px;
      margin-bottom: 15px;
      color: white;
      text-align: center;
      border-radius: 4px;
    }
    #loginContainer {
      max-width: 400px;
      margin: 0 auto;
      padding: 20px;
      border: 1px solid #ddd;
      background-color: rgba(249, 249, 249, 0.9);
    }
    #loginContainer label {
      font-weight: bold;
      margin-top: 5px;
      display: block;
    }
    #loginContainer input {
      width: 100%;
      padding: 8px;
      margin: 5px 0;
      box-sizing: border-box;
      border: 1px solid #ccc;
    }
    #loginContainer button {
      background-color: #4CAF50;
      color: white;
      padding: 10px 20px;
      border: none;
      cursor: pointer;
      width: 100%;
    }
    #loginContainer button:hover {
      background-color: #45a049;
    }
    #formContainer {
      display: none;
    }
    .three-columns {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
    }
    .three-columns .form-container input,
    .three-columns .form-container select {
      width: 32%;
    }
    .staff-name {
      width: 100% !important;
    }
  </style>
</head>
<body>

<img src="Logo1.jpg" alt="Logo" class="logo">

<div id="loginContainer">
  <h2>Login</h2>
  <label for="username">Username:</label>
  <input type="text" id="username" name="username" required>
  
  <label for="password">Password:</label>
  <input type="password" id="password" name="password" required>
  
  <button type="button" onclick="login()">Login</button>
</div>

<div id="formContainer" class="form-container">
  <h2>Sales Master Entry Form</h2>
  
  <div id="successMessage"></div>
  <div id="errorMessage"></div>

  <form id="salesForm" onsubmit="return validateForm()">
    <div class="three-columns">
      <div>
        <label for="date">Date:</label>
        <input type="date" id="date" name="date" required>
      </div>
      <div>
        <label for="staffName">Staff Name:</label>
        <select id="staffName" name="staffName" class="staff-name" required>
          <option value="">Select Staff</option>
          <option value="Rama Devi">Rama Devi</option>
          <option value="Pavani">Pavani</option>
          <option value="Jharusha">Jharusha</option>
          <option value="Keerthi">Keerthi</option>
          <option value="Surender">Surender</option>
          <option value="Sunny">Sunny</option>
          <option value="Dibyanshu">Dibyanshu</option>
          <option value="Gangaprasad">Gangaprasad</option>
          <option value="Nikhitha">Nikhitha</option>
          <option value="Reddy">Reddy</option>
          <option value="Hrithik">Hrithik</option>
          <option value="Anju">Anju</option>
          <option value="B Renuka">B Renuka</option>
          <option value="Ashwini">Ashwini</option>
          <option value="Roshini">Roshini</option>
          <option value="Dattatri">Dattatri</option>
          <option value="B Mahesh">B Mahesh</option>
          <option value="Vaishnavi">Vaishnavi</option>
          <option value="Madhusha">Madhusha</option>
          <option value="Akshaya">Akshaya</option>
          <option value="Sandhya">Sandhya</option>
        </select>
      </div>
      <div>
        <label for="totalWalkIn">Total Walk-in:</label>
        <input type="number" id="totalWalkIn" name="totalWalkIn" required>
      </div>
    </div>
    <div class="three-columns">
      <div>
        <label for="bill">Bill:</label>
        <input type="number" id="bill" name="bill" required>
      </div>
      <div>
        <label for="order">Order:</label>
        <input type="number" id="order" name="order" required>
      </div>
      <div>
        <label for="advance">Advance:</label>
        <input type="number" id="advance" name="advance" required>
      </div>
    </div>

    <div class="three-columns">
      <div>
        <label for="returnCount">Return:</label>
        <input type="number" id="returnCount" name="returnCount" required>
      </div>
      <div>
        <label for="repair">Repair:</label>
        <input type="number" id="repair" name="repair" required>
      </div>
      <div>
        <label for="npc">NPC:</label>
        <input type="number" id="npc" name="npc" required>
      </div>
    </div>

    <div class="three-columns">
      <div>
        <label for="cancelledOrders">Cancelled Orders:</label>
        <input type="number" id="cancelledOrders" name="cancelledOrders" required>
      </div>
      <div>
        <label for="npcCalls">NPC Calls:</label>
        <input type="number" id="npcCalls" name="npcCalls" required>
      </div>
      <div>
        <label for="npcVisitStore">NPC Visit Store:</label>
        <input type="number" id="npcVisitStore" name="npcVisitStore" required>
      </div>
    </div>

    <div class="three-columns">
      <div>
        <label for="googleReview">Google Review:</label>
        <input type="number" id="googleReview" name="googleReview" required>
      </div>
      <div>
        <label for="referenceCount">No. of Reference:</label>
        <input type="number" id="referenceCount" name="referenceCount" required>
      </div>
      <div>
        <label for="referenceCalls">Reference Calls:</label>
        <input type="number" id="referenceCalls" name="referenceCalls" required>
      </div>
    </div>

    <div class="three-columns">
      <div>
        <label for="referenceVisit">Reference Visit:</label>
        <input type="number" id="referenceVisit" name="referenceVisit" required>
      </div>
      <div>
        <label for="birthdayCount">Birthday's (Count):</label>
        <input type="number" id="birthdayCount" name="birthdayCount" required>
      </div>
      <div>
        <label for="anniversaryCount">Anniversary's (Count):</label>
        <input type="number" id="anniversaryCount" name="anniversaryCount" required>
      </div>
    </div>

    <div class="three-columns">
      <div>
        <label for="schemesCount">Schemes (Count):</label>
        <input type="number" id="schemesCount" name="schemesCount" required>
      </div>
      <div>
        <label for="schemesValue">Schemes (Value):</label>
        <input type="number" id="schemesValue" name="schemesValue" required>
      </div>
      <div>
        <label for="salesReturnCount">Sales Return (Count):</label>
        <input type="number" id="salesReturnCount" name="salesReturnCount" required>
      </div>
    </div>

    <div class="three-columns">
      <div>
        <label for="salesReturnValue">Sales Return (Value):</label>
        <input type="number" id="salesReturnValue" name="salesReturnValue" required>
      </div>
      <div>
        <label for="helpFirst">Help First:</label>
        <select id="helpFirst" name="helpFirst" required>
          <option value="">Select Option</option>
          <option value="Positive">Positive</option>
          <option value="Negative">Negative</option>
        </select>
      </div>
      <div>
        <label for="helpFirstRemarks">Help First Remarks:</label>
        <input type="text" id="helpFirstRemarks" name="helpFirstRemarks" required>
      </div>
    </div>

    <button type="submit">Submit</button>
  </form>
</div>

<!-- Submitted Staff Names Section -->
<div id="submittedStaffContainer" class="form-container" style="margin-top: 20px; display: none;">
  <h3>Submitted Staff Names Today</h3>
  <ul id="submittedStaffList"></ul>
</div>

<script>
  const submittedStaffNames = []; // Array to store submitted staff names

  function login() {
    const username = document.getElementById("username").value;
    const password = document.getElementById("password").value;
    
    if (username === "CRE@PJEJEWELS.COM" && password === "PJE@16105!") {
      document.getElementById("loginContainer").style.display = "none";
      document.getElementById("formContainer").style.display = "block";
    } else {
      alert("Invalid username or password");
    }
  }

  function validateForm() {
    const form = document.getElementById("salesForm");
    if (!form.checkValidity()) {
      alert("Please fill all required fields before submitting!");
      return false;
    }
    submitForm();
    return false;
  }

  function submitForm() {
    const form = document.getElementById("salesForm");
    const formData = new FormData(form);

    fetch("https://script.google.com/macros/s/AKfycbymeHUhts9BKr2sJeA0SZ7NTf7UjtDDUuD0hFRP_wO9S0jx_eTD6UsB_vWBIaUR3SND/exec", {
      method: "POST",
      body: formData
    })
    .then(response => response.text())
    .then(result => {
      const successMessage = document.getElementById("successMessage");
      const errorMessage = document.getElementById("errorMessage");

      if (result.includes("Duplicate entry")) {
        errorMessage.style.display = "block";
        errorMessage.style.backgroundColor = "red";
        errorMessage.innerText = "Duplicate Entry! Please check and try again.";
        
        setTimeout(() => errorMessage.style.display = "none", 5000);
      } else {
        form.reset();
        successMessage.style.display = "block";
        successMessage.style.backgroundColor = "green";
        successMessage.innerText = "Form submitted successfully!";
        
        setTimeout(() => successMessage.style.display = "none", 5000);
          
          // Add staff name to list
          const staffName = formData.get("staffName");
          if (!submittedStaffNames.includes(staffName)) {
            submittedStaffNames.push(staffName);
            updateSubmittedStaffList();
          }
        }
      })
      .catch((error) => console.error("Error:", error));
  }

  function updateSubmittedStaffList() {
    const submittedStaffContainer = document.getElementById("submittedStaffContainer");
    const submittedStaffList = document.getElementById("submittedStaffList");
    submittedStaffList.innerHTML = ""; // Clear existing list
    submittedStaffNames.forEach((name) => {
      const li = document.createElement("li");
      li.textContent = name;
      submittedStaffList.appendChild(li);
    });
    submittedStaffContainer.style.display = "block"; // Show the container
  }
</script>

</body>
</html>
